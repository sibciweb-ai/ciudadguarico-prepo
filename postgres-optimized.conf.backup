# Configuración optimizada de PostgreSQL para aplicación web
# Basado en configuración para un sistema con ~12GB RAM

# Memoria
shared_buffers = 256MB                 # 25% de RAM disponible para postgres
effective_cache_size = 1GB            # Estimación de caché del sistema
work_mem = 8MB                         # Memoria por operación de sort/hash
maintenance_work_mem = 64MB            # Memoria para operaciones de mantenimiento

# Conexiones
max_connections = 50                   # Reducido para mejor rendimiento
superuser_reserved_connections = 3

# WAL (Write Ahead Log) - Optimización para escritura
wal_buffers = 16MB
wal_level = replica
max_wal_size = 1GB
min_wal_size = 80MB
checkpoint_completion_target = 0.9
checkpoint_timeout = 10min

# Query Planning
random_page_cost = 1.1                # Asumiendo SSD
effective_io_concurrency = 200        # Para SSD

# Logging para debug si es necesario
log_statement = 'none'                 # Cambiar a 'all' solo para debug
log_duration = off                     # Cambiar a on solo para debug
log_slow_query = on
log_min_duration_statement = 1000     # Log queries > 1 segundo

# Autovacuum optimizado
autovacuum = on
autovacuum_max_workers = 2
autovacuum_naptime = 30s

# Estadísticas
track_activities = on
track_counts = on
track_io_timing = on
